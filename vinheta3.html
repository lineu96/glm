<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>vinheta3.utf8.md</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/simplex.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #2a211c;
    color: #bdae9d;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #bdae9d;  padding-left: 4px; }
div.sourceCode
  { color: #bdae9d; background-color: #2a211c; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ffff00; } /* Alert */
code span.an { color: #0066ff; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #44aa43; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #43a8ed; font-weight: bold; } /* ControlFlow */
code span.ch { color: #049b0a; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #0066ff; font-weight: bold; font-style: italic; } /* Comment */
code span.do { color: #0066ff; font-style: italic; } /* Documentation */
code span.dt { text-decoration: underline; } /* DataType */
code span.dv { color: #44aa43; } /* DecVal */
code span.er { color: #ffff00; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #44aa43; } /* Float */
code span.fu { color: #ff9358; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #0066ff; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #43a8ed; font-weight: bold; } /* Keyword */
code span.op { } /* Operator */
code span.pp { font-weight: bold; } /* Preprocessor */
code span.sc { color: #049b0a; } /* SpecialChar */
code span.ss { color: #049b0a; } /* SpecialString */
code span.st { color: #049b0a; } /* String */
code span.va { } /* Variable */
code span.vs { color: #049b0a; } /* VerbatimString */
code span.wa { color: #ffff00; font-weight: bold; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 41px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 46px;
  margin-top: -46px;
}
.section h2 {
  padding-top: 46px;
  margin-top: -46px;
}
.section h3 {
  padding-top: 46px;
  margin-top: -46px;
}
.section h4 {
  padding-top: 46px;
  margin-top: -46px;
}
.section h5 {
  padding-top: 46px;
  margin-top: -46px;
}
.section h6 {
  padding-top: 46px;
  margin-top: -46px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Modelos Lineares Generalizados</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-list-ol"></span>
     
    Material
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="divider"></li>
    <li>
      <a href="vinheta1.html">
        <span class="fa fa-arrow-right"></span>
         
        Regressão Linear com Erros Normais
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="vinheta2.html">
        <span class="fa fa-arrow-right"></span>
         
        Modelos de Regressão para Dados Binários
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="vinheta3.html">
        <span class="fa fa-arrow-right"></span>
         
        Modelos de Regressão para Dados de Contagem
      </a>
    </li>
    <li class="divider"></li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://lineu96.github.io/st/">
    <span class="fa fa-user"></span>
     
    Lineu A.C.F
  </a>
</li>
<li>
  <a href="https://github.com/lineu96">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">




</div>


<center>
<table>
<tr>
<td>
<img src="img/ufpr.jpg" alt="Drawing" style="width: 200px;"/>
</td>
</tr>
</table>
</center>
<hr />
<p><span class="math display">\[\textbf{Lineu Alberto Cavazani de Freitas}\]</span> <span class="math display">\[\textbf{Prof. Cesar Augusto Taconeli}\]</span> <span class="math display">\[\textbf{Modelos Lineares Generalizados (CE225)}\]</span></p>
<hr />
<center>
<font size="5">
<p align=”center”>
<b> Modelos de Regressão para Dados de Contagem </b>
</center>
</font>
</center>
<hr />
<center>
<font size="3">
<p align=”center”>
<b> Número de Acidentes de Trânsito em Municípios do Paraná em 2010 </b>
</center>
</font>
</center>
<hr />
<div id="dados" class="section level1">
<h1><span class="header-section-number">1</span> Dados</h1>
<hr />
<p>Os dados extraídos da base de dados pública do <a href="http://www.ipardes.pr.gov.br/imp/index.php">Ipardes</a> e dizem respeito ao número de acidentes de trânsito em municípios do Paraná no ano de 2010. O Batalhão de Polícia de Trânsito - BPTRAN define como acidente de trânsito todo evento ocorrido na via pública, inclusive calçadas, decorrente do trânsito de veículos e pessoas, que resulta em danos humanos e materiais.</p>
<p>Compreende: colisões entre veículos, choque com objetos fixos, capotamentos, tombamentos, atropelamentos, queda de pedestres e ciclistas, etc. Além disso toda ocorrência fortuita ou danosa, envolvendo veículos em circulação, ou parados, respectivos ocupantes, pedestres e objetos móveis ou fixos.</p>
<p>Os dados consideram apenas os acidentes de trânsito ocorridos nas vias municipais (não foram incluídos acidentes ocorridos nas Rodovias Estaduais e Federais).</p>
<p>Cada linha da base diz respeito a 1 dos 399 municípios do estado do Paraná, foram coletadas as variáveis:</p>
<p><strong>actt</strong> - Número de acidentes de trânsito no município</p>
<p><strong>pibpc</strong> - Produto Interno Bruto per Capita do município.</p>
<p><strong>ater</strong> - Área Territorial (km²).</p>
<p><strong>gurb</strong> - Grau de Urbanização, percentagem da população da área urbana em relação à população total.</p>
<p><strong>frvei</strong> - Frota total de veículos.</p>
<p><strong>pop</strong> - População Censitári.</p>
<p>O objetivo da análise foi modelar o número de acidentes de trânsito em função das demais variáveis.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">ipardes  &lt;-<span class="st"> </span><span class="kw">read.csv2</span>(<span class="st">&#39;consulta.csv&#39;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&#39;;&#39;</span>, <span class="dt">dec =</span> <span class="st">&#39;,&#39;</span>)</a></code></pre></div>
<p>As primeiras 6 linhas da base de dados tem a seguinte forma:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">head</span>(ipardes)</a></code></pre></div>
<pre><code>##                   cidade actt pibpc     ater  gurb frvei    pop
## 1              Abati\xe1   18 10414  227.898 73.83  2332   7764
## 2        Adrian\xf3polis   NA 10680 1341.334 32.31  1549   6376
## 3          Agudos do Sul    6 10535  191.282 34.12  3142   8270
## 4 Almirante Tamandar\xe9  190  6850  191.114 95.82 33697 103204
## 5  Altamira do Paran\xe1    1  8683  387.315 49.58  1101   4306
## 6        Alto Para\xedso    1 11468 1045.718 55.27  1053   3206</code></pre>
<hr />
</div>
<div id="analise-descritiva" class="section level1">
<h1><span class="header-section-number">2</span> Análise Descritiva</h1>
<p>Vamos realizar uma breve análise descritiva dos dados.</p>
<hr />
<div id="medidas-resumo" class="section level2">
<h2><span class="header-section-number">2.1</span> Medidas Resumo</h2>
<p>Usando a função summary vamos verificar o mínimo, o máximo, a mediana e os quartis das variáveis explicativas em estudo:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">summary</span>(ipardes)</a></code></pre></div>
<pre><code>##   cidade                           actt             pibpc       
##  \xc2ngulo             :  1   Min.   :    1.0   Min.   :  6305  
##  Abati\xe1             :  1   1st Qu.:    6.0   1st Qu.: 10285  
##  Adrian\xf3polis       :  1   Median :   21.0   Median : 12919  
##  Agudos do Sul         :  1   Mean   :  234.8   Mean   : 15074  
##  Almirante Tamandar\xe9:  1   3rd Qu.:   69.5   3rd Qu.: 16864  
##  Alt\xf4nia            :  1   Max.   :25109.0   Max.   :197335  
##  (Other)               :393   NA&#39;s   :44                        
##       ater              gurb            frvei              pop         
##  Min.   :  61.14   Min.   :  9.35   Min.   :    367   Min.   :   1409  
##  1st Qu.: 214.45   1st Qu.: 55.27   1st Qu.:   1766   1st Qu.:   5037  
##  Median : 351.12   Median : 71.90   Median :   3447   Median :   9026  
##  Mean   : 500.95   Mean   : 68.39   Mean   :  12636   Mean   :  26177  
##  3rd Qu.: 624.38   3rd Qu.: 84.22   3rd Qu.:   7264   3rd Qu.:  17274  
##  Max.   :3177.60   Max.   :100.00   Max.   :1197974   Max.   :1751907  
## </code></pre>
<p>Na variável cidade são elencados todos os municípios do Paraná. Para a variável resposta (número de acidentes de trânsito) nota-se um número considerável de dados faltantes; em 44 municípios não há, por algum motivo, o número de acidentes de trânsito. Para as demais variáveis é evidente a grande amplitude das respostas observadas.</p>
<hr />
</div>
<div id="boxplots" class="section level2">
<h2><span class="header-section-number">2.2</span> Boxplots</h2>
<p>O boxplot é uma alternativa de análise descritiva para avaliação da distribuição dos dados.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span><span class="kw">ncol</span>(ipardes)) {</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">  <span class="kw">boxplot</span>(ipardes[,i], </a>
<a class="sourceLine" id="cb6-5" data-line-number="5">          <span class="dt">xlab =</span> <span class="st">&#39;&#39;</span>, </a>
<a class="sourceLine" id="cb6-6" data-line-number="6">          <span class="dt">ylab =</span> <span class="st">&#39;&#39;</span>, </a>
<a class="sourceLine" id="cb6-7" data-line-number="7">          <span class="dt">main =</span> <span class="kw">names</span>(ipardes[i]), </a>
<a class="sourceLine" id="cb6-8" data-line-number="8">          <span class="dt">las=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb6-9" data-line-number="9">          <span class="dt">col =</span> <span class="st">&#39;#C8F9F3&#39;</span>)</a>
<a class="sourceLine" id="cb6-10" data-line-number="10">}</a></code></pre></div>
<p><img src="vinheta3_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Nota-se nas variáveis número de acidentes, PIB, frota e população a presença de um ponto discrepante, muito mais alto que os demais. Em alguns casos pode ser conveniente trabalhar com o log da variável para obter uma maior simetria, outra alternativa é remover os valores discrepantes.</p>
<hr />
</div>
<div id="histogramas" class="section level2">
<h2><span class="header-section-number">2.3</span> Histogramas</h2>
<p>O histograma é outra alternativa para observar a forma da distribuição dos dados.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw">library</span>(gridExtra)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"></a>
<a class="sourceLine" id="cb7-4" data-line-number="4">g1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(ipardes, <span class="kw">aes</span>(<span class="dt">x=</span>actt)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>()<span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&#39;Acidentes de Trânsito&#39;</span>)<span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&#39;&#39;</span>)</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">g2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(ipardes, <span class="kw">aes</span>(<span class="dt">x=</span>pibpc)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>()<span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&#39;PIB per capita&#39;</span>)<span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&#39;&#39;</span>)</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">g3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(ipardes, <span class="kw">aes</span>(<span class="dt">x=</span>ater)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>()<span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&#39;Área Territorial&#39;</span>)<span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&#39;&#39;</span>)</a>
<a class="sourceLine" id="cb7-7" data-line-number="7">g4 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(ipardes, <span class="kw">aes</span>(<span class="dt">x=</span>gurb)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>()<span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&#39;Grau de Urbanização&#39;</span>)<span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&#39;&#39;</span>)</a>
<a class="sourceLine" id="cb7-8" data-line-number="8">g5 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(ipardes, <span class="kw">aes</span>(<span class="dt">x=</span>frvei)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>()<span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&#39;Frota de Veículos&#39;</span>)<span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&#39;&#39;</span>)</a>
<a class="sourceLine" id="cb7-9" data-line-number="9">g6 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(ipardes, <span class="kw">aes</span>(<span class="dt">x=</span>pop)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>()<span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&#39;População&#39;</span>)<span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&#39;&#39;</span>)</a>
<a class="sourceLine" id="cb7-10" data-line-number="10"></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="kw">grid.arrange</span>(g1, g2, g3, g4, g5, g6, <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">ncol=</span><span class="dv">3</span>)</a></code></pre></div>
<p><img src="vinheta3_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>Os histogramas mostram uma considerável assimetria nas variáveis pib per capita, área territorial, frota e população, nestas variáveis pode ser considerada uma transformação.</p>
<p>O gráfico que corresponde ao histograma do número de acidentes de trânsito por munícipio é consideravelmente assimétrico devido à presença de municípios com número de acidentes muito maior que os demais, algumas delas são:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">ipardes[<span class="kw">c</span>(<span class="dv">70</span>, <span class="dv">95</span>, <span class="dv">121</span>, <span class="dv">193</span>, <span class="dv">211</span>, <span class="dv">277</span>, <span class="dv">352</span>), ]</a></code></pre></div>
<pre><code>##                         cidade  actt pibpc     ater   gurb   frvei     pop
## 70                    Cascavel  3555 18578 2091.401  94.36  157748  286205
## 95                    Curitiba 25109 33177  435.495 100.00 1197974 1751907
## 121           Foz do Igua\xe7u  2660 24388  610.209  99.17  118804  256088
## 193                   Londrina  5676 21360 1656.606  97.40  284867  506701
## 211                 Maring\xe1  6644 23958  486.433  98.20  237656  357077
## 277               Ponta Grossa  3259 21497 2025.697  97.79  140331  311611
## 352 S\xe3o Jos\xe9 dos Pinhais  2241 65244  944.280  89.66  129319  264210</code></pre>
<hr />
</div>
<div id="transformacao-das-variaveis-explicativas" class="section level2">
<h2><span class="header-section-number">2.4</span> Transformação das variáveis explicativas</h2>
<p>Vamos aplicar uma transformação logaritmica nas variáveis apontadas como mais assimétricas na análise descritiva:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">ipardes<span class="op">$</span>lpibpc &lt;-<span class="st"> </span><span class="kw">log</span>(ipardes<span class="op">$</span>pibpc)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">ipardes<span class="op">$</span>later  &lt;-<span class="st"> </span><span class="kw">log</span>(ipardes<span class="op">$</span>ater)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">ipardes<span class="op">$</span>lfrvei &lt;-<span class="st"> </span><span class="kw">log</span>(ipardes<span class="op">$</span>frvei)</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">ipardes<span class="op">$</span>lpop   &lt;-<span class="st"> </span><span class="kw">log</span>(ipardes<span class="op">$</span>pop)</a></code></pre></div>
<p>E verificar novamente a forma da distribuição das variáveis transformadas:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>))</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="kw">hist</span>(ipardes<span class="op">$</span>later, <span class="dt">main =</span> <span class="st">&#39;log(Área)&#39;</span>, <span class="dt">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="dt">ylab =</span> <span class="st">&#39;&#39;</span>, <span class="dt">col =</span> <span class="st">&#39;#F3EBAB&#39;</span>)</a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="kw">hist</span>(ipardes<span class="op">$</span>lfrvei, <span class="dt">main =</span> <span class="st">&#39;log(Frota)&#39;</span>, <span class="dt">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="dt">ylab =</span> <span class="st">&#39;&#39;</span>, <span class="dt">col =</span> <span class="st">&#39;#F3EBAB&#39;</span>)</a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="kw">hist</span>(ipardes<span class="op">$</span>lpibpc, <span class="dt">main =</span> <span class="st">&#39;log(PIB)&#39;</span>, <span class="dt">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="dt">ylab =</span> <span class="st">&#39;&#39;</span>, <span class="dt">col =</span> <span class="st">&#39;#F3EBAB&#39;</span>)</a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="kw">hist</span>(ipardes<span class="op">$</span>lpop, <span class="dt">main =</span> <span class="st">&#39;log(População)&#39;</span>, <span class="dt">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="dt">ylab =</span> <span class="st">&#39;&#39;</span>, <span class="dt">col =</span> <span class="st">&#39;#F3EBAB&#39;</span>)</a></code></pre></div>
<p><img src="vinheta3_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>E agora sim verifica-se uma simetria bem maior na distribuição das covariáveis utilizadas.</p>
<hr />
</div>
<div id="correlacao" class="section level2">
<h2><span class="header-section-number">2.5</span> Correlação</h2>
<p>Nesta etapa vamos considerar as variáveis pib per capita, área territorial, frota e população transformadas.</p>
<p>A variável resposta do estudo possui dados faltantes, para resolver este problema é possível obter a correlação desta com as demais utilizando o argumento use da função <code>cor</code></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">cor &lt;-<span class="st"> </span><span class="kw">cor</span>(ipardes[ , <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>)], <span class="dt">use =</span> <span class="st">&quot;na.or.complete&quot;</span>)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="kw">library</span>(corrplot)</a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="kw">corrplot.mixed</span>(cor, <span class="dt">upper =</span> <span class="st">&quot;ellipse&quot;</span>)</a></code></pre></div>
<p><img src="vinheta3_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>O correlograma aponta duas variáveis como mais correlacionadas com a resposta: o log da frota de veículos e o log da população. Nota-se também que essas duas variáveis são altamente correlacionadas entre si. Para fins de análise, ambas são possíveis candidatas à offssets.</p>
<hr />
</div>
<div id="graficos-de-dispersao" class="section level2">
<h2><span class="header-section-number">2.6</span> Gráficos de Dispersão</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw">plot</span>(ipardes[ , <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>)] , </a>
<a class="sourceLine" id="cb13-2" data-line-number="2">     <span class="dt">pch=</span><span class="dv">20</span> , </a>
<a class="sourceLine" id="cb13-3" data-line-number="3">     <span class="dt">cex=</span><span class="fl">1.5</span> , </a>
<a class="sourceLine" id="cb13-4" data-line-number="4">     <span class="dt">col=</span><span class="kw">rgb</span>(<span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.7</span>))</a></code></pre></div>
<p><img src="vinheta3_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>A matriz de gráficos de dispersão evidencia a alta relação entre as variáveis log da frota de veículos e o log da população; quanto à variável resposta nota-se a presença de valores altos atípicos, distantes da nuvem de pontos.</p>
<hr />
</div>
</div>
<div id="ajuste-dos-modelos-de-regressao" class="section level1">
<h1><span class="header-section-number">3</span> Ajuste dos Modelos de Regressão</h1>
<p>A variável considerada como resposta é o número de ocorrências de um evento, neste caso é o número de acidentes de trânsito; trata-se portanto de uma variável de contagem, ou seja, uma variável discreta com suporte no conjunto dos inteiros não negativos. Para problemas como este deve-se buscar uma distribuição que comporte tais características; comumente a primeira alternativa de modelagem via modelo linear generalizado faz uso da distribuição de Poisson com função de ligação logaritmica.</p>
<p>Os modelos de regressão para dados de contagem com distribuição de probabilidades Poisson para a resposta são escritos da seguinte forma:</p>
<p><span class="math display">\[
\newcommand{\undertilde}[1]{\underset{\widetilde{}}{#1}}
\]</span> <span class="math display">\[y_{i}|\undertilde{x_{i}} \sim Poisson (\mu_{i})\]</span></p>
<p><span class="math display">\[ \newcommand{\undertilde}[1]{\underset{\widetilde{}}{#1}}\]</span></p>
<p><span class="math display">\[ g(\mu_{i}) =  {\beta_{0}} + {\beta_{1}}\, x_{i1} + {\beta_{2}}\, x_{i2} + ... + {\beta_{p}}\, x_{ip}\]</span></p>
<p>Em que <span class="math inline">\(y_{i}\)</span> é a variável resposta, <span class="math inline">\(x_{i1}, x_{i2}, ..., x_{ip}\)</span> correspondem às variáveis explicativas.</p>
<p>Além disso, <span class="math inline">\(g(\mu_{i})\)</span> é a função de ligação. Se trata de uma função real, monótona e diferenciável, que associa e lineariza a relação entre o componente aleatório e o sistemático do modelo. A função de ligação canônica para um GLM Poisson é a logaritmica. Vale lembrar que como se trata de uma contagem, os valores preditos na escala da resposta não podem ser negativos e cabe à função de ligação garantir a não negatividade dos valores preditos.</p>
<p>Caso o GLM Poisson não se ajuste bem há outras opções de distribuições para a resposta. Uma das alternativas mais utilizadas é a Binomial Negativa. O principal diferencial dessa distribuição em relação à Poisson é que a Binomial Negativa comporta casos em que há superdispersão, enquanto na Poisson o parâmetro de dispersão deve ser fixo e igual a 1 (equidispersão, média igual à variância).</p>
<p>Nas subseções seguintes são mostrados os ajustes dos Modelos Lineares Generalizados log-linear de Poisson e com distribuição Binomial Negativa para a resposta.</p>
<hr />
<div id="glm-com-resposta-poisson" class="section level2">
<h2><span class="header-section-number">3.1</span> GLM com resposta Poisson</h2>
<p>Vamos ajustar um Modelo Linear Generalizado Poisson com função de ligação logaritmica e com as covariáveis inclusas de forma aditiva no modelo. A expressão do modelo é dada por:</p>
<p><span class="math display">\[
\newcommand{\undertilde}[1]{\underset{\widetilde{}}{#1}}
\]</span></p>
<p><span class="math display">\[y_{i}|\undertilde{x_{i}} \sim Poisson (\mu_{i})\]</span></p>
<p><span class="math display">\[ \newcommand{\undertilde}[1]{\underset{\widetilde{}}{#1}}\]</span></p>
<p><span class="math display">\[ log(\mu _{i})
 =  {\beta_{0}} + {\beta_{1}}\, lpibpc_{i} + {\beta_{2}}\, later_{i} + {\beta_{3}}\, gurb_{i} +\ {\beta_{4}}\, lfrvei_{i} + {\beta_{5}}\, lpop_{i}\]</span></p>
<p>No R, o modelo é declarado da seguinte forma:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">m1 &lt;-<span class="st"> </span><span class="kw">glm</span>(actt <span class="op">~</span><span class="st"> </span>lpibpc <span class="op">+</span><span class="st"> </span>later <span class="op">+</span><span class="st"> </span>gurb <span class="op">+</span><span class="st"> </span>lfrvei <span class="op">+</span><span class="st"> </span>lpop, <span class="dt">data =</span> ipardes, <span class="dt">family =</span> <span class="st">&#39;poisson&#39;</span>)</a></code></pre></div>
<hr />
</div>
<div id="glm-com-resposta-binomial-negativa" class="section level2">
<h2><span class="header-section-number">3.2</span> GLM com resposta Binomial Negativa</h2>
<p>Vamos ajustar um Modelo Linear Generalizado com distribuição Binomial negativa com função de ligação logaritimica. A expressão do modelo é igual ao do modelo Poisson, porém a distribuição da resposta tem forma diferente.</p>
<p>No R, o modelo é declarado da seguinte forma:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">library</span>(MASS)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2"></a>
<a class="sourceLine" id="cb15-3" data-line-number="3">m2 &lt;-<span class="st"> </span><span class="kw">glm.nb</span>(actt <span class="op">~</span><span class="st"> </span>lpibpc <span class="op">+</span><span class="st"> </span>later <span class="op">+</span><span class="st"> </span>gurb <span class="op">+</span><span class="st"> </span>lfrvei <span class="op">+</span><span class="st"> </span>lpop, <span class="dt">data =</span> ipardes)</a></code></pre></div>
</div>
</div>
<div id="escolha-do-modelo" class="section level1">
<h1><span class="header-section-number">4</span> Escolha do Modelo</h1>
<p>Para seleção de modelos diversas medidas podem ser utilizadas, em especial vamos utilizar a verossimilhança e o AIC dos modelos. vale lembrar que o modelo Binomial Negativo estima um parâmetro de dispersão que não existe no modelo Poisson.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">ajuste =<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;m1&#39;</span>, <span class="st">&#39;m2&#39;</span>)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2"></a>
<a class="sourceLine" id="cb16-3" data-line-number="3">aic    =<span class="st"> </span><span class="kw">c</span>(<span class="kw">AIC</span>(m1), <span class="kw">AIC</span>(m2))</a>
<a class="sourceLine" id="cb16-4" data-line-number="4"></a>
<a class="sourceLine" id="cb16-5" data-line-number="5">verossimilhança =<span class="st"> </span><span class="kw">c</span>(<span class="kw">logLik</span>(m1),<span class="kw">logLik</span>(m2))</a>
<a class="sourceLine" id="cb16-6" data-line-number="6"></a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="kw">data.frame</span>(ajuste, aic, verossimilhança)</a></code></pre></div>
<pre><code>##   ajuste      aic verossimilhança
## 1     m1 8533.970       -4260.985
## 2     m2 2980.105       -1483.052</code></pre>
<p>O modelo que apresentou menor AIC e maior verossimilhança foi o modelo Binomial Negativo. Adicionalmente, vamos verificar o comportamento dos gráficos meio Normais de probabilidades com envelopes simulados.</p>
<p>Esses gráficos permitem verificar a adequação do modelo ajustado mesmo que os resíduos não tenham uma aproximação adequada com a distribuição Normal. Sendo assim, neste tipo de gráfico espera-se, para um modelo bem ajustado, os pontos (resíduos) dispersos aleatoriamente entre os limites do envelope.</p>
<p>Deve-se ficar atento à presença de pontos fora dos limites do envelope ou ainda a pontos dentro dos limites porém apresentando padrões sistemáticos.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw">library</span>(hnp)</a>
<a class="sourceLine" id="cb18-2" data-line-number="2"></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb18-4" data-line-number="4"></a>
<a class="sourceLine" id="cb18-5" data-line-number="5"><span class="kw">hnp</span>(m1, <span class="dt">xlab =</span> <span class="st">&#39;Percentil da N(0,1)&#39;</span>, </a>
<a class="sourceLine" id="cb18-6" data-line-number="6">    <span class="dt">ylab =</span> <span class="st">&#39;Resíduos&#39;</span>, </a>
<a class="sourceLine" id="cb18-7" data-line-number="7">    <span class="dt">main =</span> <span class="st">&#39;Poisson&#39;</span>)</a>
<a class="sourceLine" id="cb18-8" data-line-number="8"></a>
<a class="sourceLine" id="cb18-9" data-line-number="9"><span class="kw">hnp</span>(m2, <span class="dt">xlab =</span> <span class="st">&#39;Percentil da N(0,1)&#39;</span>, </a>
<a class="sourceLine" id="cb18-10" data-line-number="10">    <span class="dt">ylab =</span> <span class="st">&#39;Resíduos&#39;</span>, </a>
<a class="sourceLine" id="cb18-11" data-line-number="11">    <span class="dt">main =</span> <span class="st">&#39;Binomial Negativa&#39;</span>)</a></code></pre></div>
<p><img src="vinheta3_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>Nota-se pelas medidas de qualidade de ajuste e o comportamento dos resíduos no gráfico a total falta de aderência à distribuição de Poison; alterando a distribuição da resposta para Binomial Negativa obteve-se um ajuste satisfatório.</p>
<hr />
</div>
<div id="modelo-escolhido" class="section level1">
<h1><span class="header-section-number">5</span> Modelo Escolhido</h1>
<p>Vamos seguir as análises fazendo uso do modelo Binomial Negativo.</p>
<hr />
<div id="resumo-do-modelo" class="section level2">
<h2><span class="header-section-number">5.1</span> Resumo do Modelo</h2>
<p>O modelo original foi ajustado usando todas as covariáveis disponíveis. Vamos verificar no resumo do modelo selecionado quais covariáveis são apontadas como significativas:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw">summary</span>(m2)</a></code></pre></div>
<pre><code>## 
## Call:
## glm.nb(formula = actt ~ lpibpc + later + gurb + lfrvei + lpop, 
##     data = ipardes, init.theta = 3.664147641, link = log)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -3.1819  -0.8559  -0.1779   0.4794   3.0907  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -10.216771   0.891832 -11.456  &lt; 2e-16 ***
## lpibpc        0.134996   0.083845   1.610    0.107    
## later         0.055948   0.055061   1.016    0.310    
## gurb          0.011501   0.002046   5.620 1.91e-08 ***
## lfrvei        1.171845   0.156376   7.494 6.69e-14 ***
## lpop          0.141566   0.168776   0.839    0.402    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Negative Binomial(3.6641) family taken to be 1)
## 
##     Null deviance: 5472.55  on 354  degrees of freedom
## Residual deviance:  382.48  on 349  degrees of freedom
##   (44 observations deleted due to missingness)
## AIC: 2980.1
## 
## Number of Fisher Scoring iterations: 1
## 
## 
##               Theta:  3.664 
##           Std. Err.:  0.342 
## 
##  2 x log-likelihood:  -2966.105</code></pre>
<p>O resumo do modelo ajustado indica que as variáveis grau de urbanização e log da frota de veículos foram significativas. No resumo é mostrado também o valor do parâmetro de dispersão (neste caso vale 3,6), muito maior que 1, o que explica a falta de ajuste à distribuição de Poisson.</p>
<hr />
</div>
<div id="reajuste-do-modelo" class="section level2">
<h2><span class="header-section-number">5.2</span> Reajuste do Modelo</h2>
<p>Como há um par de covariáveis altamente correlacionadas (log da frota e log da população), é válido inserir as covariáveis uma a uma no modelo para verificar sua significância na presença das outras; tal como o realizado pelo algoritmo stepwise. Notou-se que ao retirar a variável log da frota, o log da população se mostra significativo.</p>
<p>Sendo assim, o novo modelo fica da seguinte forma:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">m2<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">step</span>(m2, <span class="dt">direction =</span> <span class="st">&quot;both&quot;</span>)</a></code></pre></div>
<p>O resumo do novo modelo ajustado:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw">summary</span>(m2<span class="fl">.1</span>)</a></code></pre></div>
<pre><code>## 
## Call:
## glm.nb(formula = actt ~ gurb + lfrvei, data = ipardes, init.theta = 3.615959105, 
##     link = log)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -3.0461  -0.8343  -0.1949   0.4698   3.2940  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -8.603487   0.231379 -37.183  &lt; 2e-16 ***
## gurb         0.010333   0.001837   5.625 1.85e-08 ***
## lfrvei       1.340227   0.030368  44.133  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Negative Binomial(3.616) family taken to be 1)
## 
##     Null deviance: 5405.25  on 354  degrees of freedom
## Residual deviance:  383.23  on 352  degrees of freedom
##   (44 observations deleted due to missingness)
## AIC: 2978.6
## 
## Number of Fisher Scoring iterations: 1
## 
## 
##               Theta:  3.616 
##           Std. Err.:  0.336 
## 
##  2 x log-likelihood:  -2970.646</code></pre>
<p>O algoritmo indica que as variáveis grau de urbanização e log da frota são significativas e tem relação positiva com o número de acidentes de trânsito.</p>
<p>Agora, vamos realizar o teste da razão de verossimilhança do modelo inicial e do reduzido:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw">anova</span>(m2, m2<span class="fl">.1</span>)</a></code></pre></div>
<pre><code>## Likelihood ratio tests of Negative Binomial Models
## 
## Response: actt
##                                   Model    theta Resid. df    2 x log-lik.
## 1                         gurb + lfrvei 3.615959       352       -2970.646
## 2 lpibpc + later + gurb + lfrvei + lpop 3.664148       349       -2966.105
##     Test    df LR stat.   Pr(Chi)
## 1                                
## 2 1 vs 2     3 4.540832 0.2086769</code></pre>
<p>O p-valor do teste foi relativamente alto, portanto pode-se concluir que o modelo restrito se ajusta aos dados amostrais tão bem quanto o modelo considerando todas as covariáveis. Portanto o modelo final fica expresso por:</p>
<p><span class="math display">\[
\newcommand{\undertilde}[1]{\underset{\widetilde{}}{#1}}
\]</span></p>
<p><span class="math display">\[y_{i}|\undertilde{x_{i}} \sim Binomial\; Negativa (\mu_{i}, \phi)\]</span></p>
<p><span class="math display">\[ \newcommand{\undertilde}[1]{\underset{\widetilde{}}{#1}}\]</span></p>
<p><span class="math display">\[ \log(\mu _{i}) =  { -8.60349} + {0.01033}\, gurb_{i} + {1.34023}\, log(frvei_{i})\]</span></p>
<hr />
</div>
<div id="medidas-de-influencia" class="section level2">
<h2><span class="header-section-number">5.3</span> Medidas de Influência</h2>
<p>Uma alternativa para verificação de medidas influentes está implementada no pacote car:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="kw">library</span>(car)</a></code></pre></div>
<pre><code>## Loading required package: carData</code></pre>
<pre><code>## 
## Attaching package: &#39;car&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     recode</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     some</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="kw">influenceIndexPlot</span>(m2<span class="fl">.1</span>, <span class="dt">vars=</span><span class="kw">c</span>(<span class="st">&quot;Cook&quot;</span>, <span class="st">&quot;Studentized&quot;</span>, <span class="st">&quot;hat&quot;</span>), <span class="dt">main=</span><span class="st">&quot;Medidas de Influência&quot;)</span></a></code></pre></div>
<p><img src="vinheta3_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>O primeiro gráfico apresenta os valores da distância de Cook para cada observação. A distância de Cook é uma medida de diferença das estimativas dos parâmetros do modelo ao considerar e ao desconsiderar uma particular observação no ajuste.</p>
<p>O segundo gráfico mostra os resíduos studentizados; um modelo bem ajustado apresenta estes resíduos dispersos aleatóriamente em torno de 0, entre -3 e 3 desvios.</p>
<p>O terceiro gráfico mostra os valores da matriz chapéu (H). Valores elevados são considerados potencialmente influentes. Os valores da matriz chapéu estão entre 0 e 1. A soma dos elementos da diagonal da matriz H equivale ao posto da matriz X de delineamento.</p>
<p>Com base nesses 3 gráficos, não há indicativos fortes de outliers ou observações influentes.</p>
<hr />
</div>
<div id="residuos-quantilicos-aleatorizados" class="section level2">
<h2><span class="header-section-number">5.4</span> Resíduos Quantílicos Aleatorizados</h2>
<p>Outra alternativa para avaliar a qualidade do ajuste é baseada nos resíduos quantílicos aleatorizados. A função <code>qresiduals</code> do pacote statmod extrai este tipo de resíduos do modelo</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw">library</span>(statmod)</a></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb33-2" data-line-number="2"></a>
<a class="sourceLine" id="cb33-3" data-line-number="3">res &lt;-<span class="st"> </span><span class="kw">qresiduals</span>(m2<span class="fl">.1</span>)</a>
<a class="sourceLine" id="cb33-4" data-line-number="4"></a>
<a class="sourceLine" id="cb33-5" data-line-number="5"><span class="kw">plot</span>(res)</a>
<a class="sourceLine" id="cb33-6" data-line-number="6"></a>
<a class="sourceLine" id="cb33-7" data-line-number="7">residuos &lt;-<span class="st"> </span><span class="kw">qresiduals</span>(m2<span class="fl">.1</span>)</a>
<a class="sourceLine" id="cb33-8" data-line-number="8"><span class="kw">qqnorm</span>(residuos)</a>
<a class="sourceLine" id="cb33-9" data-line-number="9"><span class="kw">qqline</span>(residuos, <span class="dt">col =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="vinheta3_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>No gráfico da esquerda nota-se que os resíduos estão dispersos predominantemente em torno de 0 entre -2 e 2. Além disso, no gráfico a direita verifica-se que os resíduos apresentam razoável aderência à distribuição Normal. Há um leve indício de caudas pesadas; porém, no geral, parece que há um ajuste plausível.</p>
<hr />
</div>
<div id="grafico-normal-de-probabilidades-com-envelope-simulado" class="section level2">
<h2><span class="header-section-number">5.5</span> Gráfico Normal de Probabilidades com Envelope Simulado</h2>
<p>Vamos verificar o comportamento do gráfico Normal de probabilidades com envelope simulado para o modelo reajustado:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="kw">hnp</span>(m2, <span class="dt">xlab =</span> <span class="st">&#39;Percentil da N(0,1)&#39;</span>, </a>
<a class="sourceLine" id="cb34-2" data-line-number="2">    <span class="dt">ylab =</span> <span class="st">&#39;Resíduos&#39;</span>, </a>
<a class="sourceLine" id="cb34-3" data-line-number="3">    <span class="dt">main =</span> <span class="st">&#39;Gráfico Normal de Probabilidades&#39;</span>)</a></code></pre></div>
<pre><code>## Negative binomial model (using MASS package)</code></pre>
<p><img src="vinheta3_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>Os resíduos estão dispersos no interior dos envelopes simulados, sem aparente padrão sistemático dando indício de que o modelo está bem ajustado.</p>
<hr />
</div>
<div id="graficos-de-efeitos" class="section level2">
<h2><span class="header-section-number">5.6</span> Gráficos de Efeitos</h2>
<p>A função <code>effects</code>, do pacote de mesmo nome, devolve os efeitos marginais de cada variável de um modelo ajustado; os gráficos de efeitos nos fornecem uma forma visual de observar como cada variável explicativa afeta a resposta, com as demais variáveis fixadas na média.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="kw">library</span>(effects)</a></code></pre></div>
<pre><code>## Registered S3 methods overwritten by &#39;lme4&#39;:
##   method                          from
##   cooks.distance.influence.merMod car 
##   influence.merMod                car 
##   dfbeta.influence.merMod         car 
##   dfbetas.influence.merMod        car</code></pre>
<pre><code>## lattice theme set by effectsTheme()
## See ?effectsTheme for details.</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="kw">plot</span>(<span class="kw">allEffects</span>(m2<span class="fl">.1</span>), <span class="dt">type =</span> <span class="st">&#39;response&#39;</span>, <span class="dt">main =</span> <span class="st">&#39;&#39;</span>)</a></code></pre></div>
<p><img src="vinheta3_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<hr />
</div>
</div>
<div id="predicao" class="section level1">
<h1><span class="header-section-number">6</span> Predição</h1>
<p>Para fins de ilustração, vamos considerar os seguintes perfis para três municípios distintos:</p>
<p><strong>Perfil 1:</strong></p>
<ol style="list-style-type: decimal">
<li>Grau de Urbanização = 10<br />
</li>
<li>Log da frota de veículos = 8</li>
</ol>
<p><strong>Perfil 2</strong></p>
<ol style="list-style-type: decimal">
<li>Grau de Urbanização = 70<br />
</li>
<li>Log da frota de veículos = 10</li>
</ol>
<p><strong>Perfil 3</strong></p>
<ol style="list-style-type: decimal">
<li>Grau de Urbanização = 100<br />
</li>
<li>Log da frota de veículos = 12</li>
</ol>
<p>E responder à seguinte pergunta: <em>Qual é o número esperado de acidentes de trânsito em municípios com o Perfil 1, 2 e 3?</em></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1">perfis &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">gurb   =</span>  <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">70</span>, <span class="dv">100</span>), </a>
<a class="sourceLine" id="cb40-2" data-line-number="2">                     <span class="dt">lfrvei =</span>  <span class="kw">c</span>(<span class="dv">8</span>,  <span class="dv">10</span>,  <span class="dv">12</span>))</a></code></pre></div>
<p>Utilizando a função predict para obter o número esperado de acidentes nos perfis:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="kw">predict</span>(m2<span class="fl">.1</span>, <span class="dt">interval =</span> <span class="st">&#39;prediction&#39;</span>, <span class="dt">newdata =</span> perfis, <span class="dt">type =</span> <span class="st">&#39;response&#39;</span>)</a></code></pre></div>
<pre><code>##           1           2           3 
##    9.222629  250.156084 4976.712891</code></pre>
<p>Portanto, o número esperado de acidentes de trânsito para um município fictício com o Perfil 1 é igual a 9; para um município com o Perfil 2 este número passa para 250, e no teceiro perfil o número esperado de acidentes é de 4976.</p>
<hr />
</div>
<div id="outra-abordagem-quase-verossimilhanca" class="section level1">
<h1><span class="header-section-number">7</span> Outra Abordagem: Quase-Verossimilhança</h1>
<p>Os modelos de quase-verossimilhança são uma forma de modelagem mais flexível quando comparada aos modelos lineares generalizados; o método consiste em especificar um modelo baseado aoenas na média e variância da distribuição tornando-o mais flexível, o que muitas vezes é o suficiente para acomodar superdispersão nos dados.</p>
<p>Tais como os estimadores de máxima verossimilhança, os estimadores de máxima quase-verossimilhança são assintóticamente não viciados, consistentes e normalmente distribuídos.</p>
<hr />
<div id="ajuste-do-modelo" class="section level2">
<h2><span class="header-section-number">7.1</span> Ajuste do modelo</h2>
<p>Vamos reajustar o modelo por quase-verossimilhança:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1">mq &lt;-<span class="st"> </span><span class="kw">glm</span>(actt <span class="op">~</span><span class="st"> </span>lpibpc <span class="op">+</span><span class="st"> </span>later <span class="op">+</span><span class="st"> </span>gurb <span class="op">+</span><span class="st"> </span>lfrvei <span class="op">+</span><span class="st"> </span>lpop, <span class="dt">data =</span> ipardes, </a>
<a class="sourceLine" id="cb43-2" data-line-number="2">          <span class="dt">family =</span> <span class="kw">quasi</span>(<span class="dt">variance =</span> <span class="st">&quot;mu^2&quot;</span>, <span class="dt">link =</span> <span class="st">&quot;log&quot;</span>))</a></code></pre></div>
</div>
<div id="diagnostico" class="section level2">
<h2><span class="header-section-number">7.2</span> Diagnóstico</h2>
<p>Com o modelo ajustado pode-se realizar a análise de diagnóstico:</p>
<div id="medidas-de-influencia-1" class="section level3">
<h3><span class="header-section-number">7.2.1</span> Medidas de Influência</h3>
<p>Vamos iniciar com a verificação de possíveis medidas influentes:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1"><span class="kw">library</span>(car)</a>
<a class="sourceLine" id="cb44-2" data-line-number="2"></a>
<a class="sourceLine" id="cb44-3" data-line-number="3"><span class="kw">influenceIndexPlot</span>(mq, <span class="dt">vars=</span><span class="kw">c</span>(<span class="st">&quot;Cook&quot;</span>, <span class="st">&quot;Studentized&quot;</span>, <span class="st">&quot;hat&quot;</span>), <span class="dt">main=</span><span class="st">&quot;Medidas de Influência&quot;)</span></a></code></pre></div>
<p><img src="vinheta3_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p>Uma das observações apontadas como fortemente influente é o município de Guaraqueçaba:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1">ipardes[<span class="dv">138</span>,]</a></code></pre></div>
<pre><code>##              cidade actt pibpc     ater  gurb frvei  pop   lpibpc    later
## 138 Guaraque\xe7aba    5  7438 2315.733 34.09   367 7871 8.914357 7.747482
##       lfrvei    lpop
## 138 5.905362 8.97094</code></pre>
<hr />
</div>
<div id="residuos" class="section level3">
<h3><span class="header-section-number">7.2.2</span> Resíduos</h3>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1"><span class="kw">qqnorm</span>(<span class="kw">resid</span>(mq, <span class="dt">type =</span> <span class="st">&quot;deviance&quot;</span>),</a>
<a class="sourceLine" id="cb47-2" data-line-number="2">       <span class="dt">pch =</span> <span class="dv">20</span>, <span class="dt">main =</span> <span class="st">&quot;Resíduos do modelo de Quase-Verossimilhança&quot;</span>, <span class="dt">las =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb47-3" data-line-number="3"></a>
<a class="sourceLine" id="cb47-4" data-line-number="4"><span class="kw">qqline</span>(<span class="kw">resid</span>(mq, <span class="dt">type =</span> <span class="st">&quot;deviance&quot;</span>), <span class="dt">col =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="vinheta3_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<p>Os resíduos componentes da Deviance para o modelo de Quase-Verossimilhança ajustado têm distribuição aproximadamente Normal.</p>
<hr />
<p>Sendo assim, o modelo de Quase-Verossimilhança é mais uma alternativa para modelagem de dados de contagem sendo que esta, diferente das duas primeiras apresentadas, tem enfoque não paramétrico.</p>
<hr />
<center>
<table>
<tr>
<td>
<img src="img/logo.png" alt="Drawing" style="width: 200px;"/>
</td>
<td>
<img src="img/LogoB.png" alt="Drawing" style="width: 50px;"/>
</td>
<td>
<img src="img/ufpr.jpg" alt="Drawing" style="width: 200px;"/>
</td>
<td>
<img src="img/LogoB.png" alt="Drawing" style="width: 50px;"/>
</td>
<td>
<img src="img/leg.png" alt="Drawing" style="width: 150px;"/>
</td>
</tr>
</table>
</center>
<div class="tocify-extend-page" data-unique="tocify-extend-page" style="height: 0;">

</div>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
